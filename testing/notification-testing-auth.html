<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>Socket.IO WebSocket Test</title>
  <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    textarea { width: 100%; height: 100px; }
    .log { margin-top: 20px; padding: 10px; background: #f1f1f1; height: 200px; overflow-y: auto; }
    .status { font-weight: bold; margin-bottom: 10px; }
  </style>
</head>
<body>

  <h1>WebSocket Test Client (Socket.IO)</h1>

  <button onclick="connectSocket()">Connect</button>
  <button onclick="disconnectSocket()">Disconnect</button>

  <div class="status" id="status">Not connected</div>

  <div class="log" id="log"></div>

  <script>
    let socket;

    function log(message) {
      const logEl = document.getElementById('log');
      logEl.innerHTML += `<div>${new Date().toLocaleTimeString()} - ${message}</div>`;
      logEl.scrollTop = logEl.scrollHeight;
    }

function connectSocket() {
  const token = "eyJraWQiOiJsc3hjVUJaaFVLZVl0SGo4SlRWeEtNc1d5a1wvbVwvSkFFeHAzc3haQUd5MVE9IiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiIxOTllNDQ1OC1hMGIxLTcwMWUtMWVkYi1iMzc4ZTczYWViZmMiLCJpc3MiOiJodHRwczpcL1wvY29nbml0by1pZHAuYXAtc291dGhlYXN0LTIuYW1hem9uYXdzLmNvbVwvYXAtc291dGhlYXN0LTJfSGFWYUtYdUtKIiwidmVyc2lvbiI6MiwiY2xpZW50X2lkIjoiMWFiOGgwYWVmNWltcjh1YjJhMWRqa3BscGMiLCJvcmlnaW5fanRpIjoiNDIwMWRiYmUtMzA3Ny00ZmUxLTljOGYtMTQwZDZmYTc5ZGM3IiwiZXZlbnRfaWQiOiI5NWUyOGJlMS04MTE3LTRhODQtYTQ3Mi1mYWM5MjBhNDJkZTUiLCJ0b2tlbl91c2UiOiJhY2Nlc3MiLCJzY29wZSI6InBob25lIG9wZW5pZCBlbWFpbCIsImF1dGhfdGltZSI6MTc2MTI4NTg0MiwiZXhwIjoxNzYxMjkzMTUzLCJpYXQiOjE3NjEyODk1NTMsImp0aSI6ImQzZTM2ODE4LWJjODgtNDZmZC1hYmUyLTExZmMyMjM4Mjc0YiIsInVzZXJuYW1lIjoiMTk5ZTQ0NTgtYTBiMS03MDFlLTFlZGItYjM3OGU3M2FlYmZjIn0.dCDwAIhbFoA1ZvyMTOABpEWCeUyEiGHVe92IWadXrDdNW-TYiwyTfjqWCK79ECG4DGL5ryXf6Hd4ahqmkREyTe8jATEEt76SSQ66nhJsQogKqB_gLqqzlUDscFU222YgxOoMoKKefqa3LtGZjKZuluQzsLpmLv8_hzImR4eZBSmCfcpxDNAKFB50JRunwEJYb9fcIQbv_J6DgXJJE6KtWa8N9ArWoM1pu26S52RF48rtWFsSFtLnrK_Fj5ZgbnKjCgNGTOwHjsSORg4P7naLLfytWSRUVm6MHwQ9kAKRiYAGR-u0wtEx6R39cipT7shEoqbirQ8SjPgROIRRAIoKmg"; // Replace with your JWT

  socket = io('http://localhost:4000', {
    auth: {
      token: token
    }
  });

  socket.on('connect', () => {
    document.getElementById('status').textContent = `Connected as ${socket.id}`;
    log('Connected to WebSocket server');
  });

  socket.on('newNotification', (data) => {
    log('📨 New Notification: ' + JSON.stringify(data));
  });

  socket.on('connect_error', (err) => {
    document.getElementById('status').textContent = 'Connection failed';
    log('❌ Connection error: ' + err.message);
  });

  socket.on('disconnect', () => {
    document.getElementById('status').textContent = 'Disconnected';
    log('Disconnected from server');
  });
}

    function disconnectSocket() {
      if (socket) {
        socket.disconnect();
        socket = null;
        document.getElementById('status').textContent = 'Disconnected';
        log('Manually disconnected');
      }
    }
  </script>

</body>
</html>
