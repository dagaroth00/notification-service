<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>Socket.IO WebSocket Test</title>
  <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    textarea { width: 100%; height: 100px; }
    .log { margin-top: 20px; padding: 10px; background: #f1f1f1; height: 200px; overflow-y: auto; }
    .status { font-weight: bold; margin-bottom: 10px; }
  </style>
</head>
<body>

  <h1>WebSocket Test Client (Socket.IO)</h1>

  <button onclick="connectSocket()">Connect</button>
  <button onclick="disconnectSocket()">Disconnect</button>

  <div class="status" id="status">Not connected</div>

  <div class="log" id="log"></div>

  <script>
    let socket;

    function log(message) {
      const logEl = document.getElementById('log');
      logEl.innerHTML += `<div>${new Date().toLocaleTimeString()} - ${message}</div>`;
      logEl.scrollTop = logEl.scrollHeight;
    }

    function connectSocket() {
      socket = io('http://localhost:4000');  // No authentication required

      socket.on('connect', () => {
        document.getElementById('status').textContent = `Connected as ${socket.id}`;
        log('Connected to WebSocket server');
      });

      socket.on('newNotification', (data) => {
        log('ðŸ“¨ New Notification: ' + JSON.stringify(data));
      });

      socket.on('connect_error', (err) => {
        document.getElementById('status').textContent = 'Connection failed';
        log('âŒ Connection error: ' + err.message);
      });

      socket.on('disconnect', () => {
        document.getElementById('status').textContent = 'Disconnected';
        log('Disconnected from server');
      });
    }

    function disconnectSocket() {
      if (socket) {
        socket.disconnect();
        socket = null;
        document.getElementById('status').textContent = 'Disconnected';
        log('Manually disconnected');
      }
    }
  </script>

</body>
</html>
